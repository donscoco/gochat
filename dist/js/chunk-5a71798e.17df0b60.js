(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a71798e"],{"289b":function(e,t,i){},"35fb":function(e,t,i){"use strict";i("289b")},"4e44":function(e,t,i){},"63b9":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("el-container",[t("el-aside",{staticClass:"l-friend-box",attrs:{width:"250px"}},[t("div",{staticClass:"l-friend-header"},[t("div",{staticClass:"l-friend-search"},[t("el-input",{attrs:{width:"200px",placeholder:"搜索好友"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t("el-button",{staticStyle:{border:"none",padding:"12px","font-size":"20px",color:"black"},attrs:{plain:"",icon:"el-icon-plus",title:"添加好友"},on:{click:function(t){return e.handleShowAddFriend()}}}),t("add-friend",{attrs:{dialogVisible:e.showAddFriend},on:{close:e.handleCloseAddFriend}})],1),t("el-scrollbar",{staticClass:"l-friend-list"},e._l(e.$store.state.friendStore.friends,(function(i,s){return t("div",{key:s},[t("friend-item",{directives:[{name:"show",rawName:"v-show",value:i.nickName.startsWith(e.searchText),expression:"friend.nickName.startsWith(searchText)"}],attrs:{friend:i,index:s,active:s===e.$store.state.friendStore.activeIndex},on:{del:function(t){return e.handleDelItem(i,s)}},nativeOn:{click:function(t){return e.handleActiveItem(i,s)}}})],1)})),0)],1),t("el-container",{staticClass:"r-friend-box"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.userInfo.id,expression:"userInfo.id"}],staticClass:"r-friend-header"},[e._v(" "+e._s(e.userInfo.nickName)+" ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.userInfo.id,expression:"userInfo.id"}]},[t("div",{staticClass:"user-detail"},[t("head-image",{staticClass:"detail-head-image",attrs:{size:200,url:e.userInfo.headImage},nativeOn:{click:function(t){return e.showFullImage()}}}),t("div",{staticClass:"info-item"},[t("el-descriptions",{staticClass:"description",attrs:{title:"好友信息",column:1}},[t("el-descriptions-item",{attrs:{label:"用户名"}},[e._v(e._s(e.userInfo.userName)+" ")]),t("el-descriptions-item",{attrs:{label:"昵称"}},[e._v(e._s(e.userInfo.nickName)+" ")]),t("el-descriptions-item",{attrs:{label:"性别"}},[e._v(e._s(0==e.userInfo.sex?"男":"女"))]),t("el-descriptions-item",{attrs:{label:"签名"}},[e._v(e._s(e.userInfo.signature))])],1)],1)],1),t("div",{staticClass:"btn-group"},[t("el-button",{staticClass:"send-btn",on:{click:function(t){return e.handleSendMessage()}}},[e._v("发消息")])],1)])])],1)},n=[],a=(i("14d9"),i("ff36")),r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"添加好友",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"输入好友昵称,最多展示10条"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch()}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.handleSearch()}},slot:"append"})],1),t("el-scrollbar",{staticStyle:{height:"400px"}},e._l(e.users,(function(i){return t("div",{directives:[{name:"show",rawName:"v-show",value:i.id!=e.$store.state.userStore.userInfo.id,expression:"user.id != $store.state.userStore.userInfo.id"}],key:i.id},[t("div",{staticClass:"item"},[t("div",{staticClass:"avatar"},[t("head-image",{attrs:{url:i.headImage}})],1),t("div",{staticClass:"add-friend-text"},[t("div",[e._v(e._s(i.nickName))]),t("div",{class:i.online?"online-status  online":"online-status"},[e._v(e._s(i.online?"[在线]":"[离线]"))])]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isFriend(i.id),expression:"!isFriend(user.id)"}],attrs:{type:"success",plain:""},on:{click:function(t){return e.handleAddFriend(i)}}},[e._v("添加")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isFriend(i.id),expression:"isFriend(user.id)"}],attrs:{type:"info",plain:"",disabled:""}},[e._v("已添加")])],1)])})),0)],1)},d=[],o=i("4036"),l={name:"addFriend",components:{HeadImage:o["a"]},data(){return{users:[],searchText:""}},props:{dialogVisible:{type:Boolean}},methods:{handleClose(){this.$emit("close")},handleSearch(){this.$http({url:"/user/findByNickName",method:"get",params:{nickName:this.searchText}}).then(e=>{this.users=e})},handleAddFriend(e){this.$http({url:"/friend/add",method:"post",params:{friendId:e.id}}).then(t=>{this.$message.success("添加成功，对方已成为您的好友");let i={id:e.id,nickName:e.nickName,headImage:e.headImage,online:e.online};this.$store.commit("addFriend",i)})},isFriend(e){let t=this.$store.state.friendStore.friends,i=t.find(t=>t.id==e);return void 0!=i}},mounted(){this.handleSearch()}},c=l,h=(i("7875"),i("2877")),u=Object(h["a"])(c,r,d,!1,null,"1b3ff3b4",null),m=u.exports,f={name:"friend",components:{FriendItem:a["a"],AddFriend:m,HeadImage:o["a"]},data(){return{searchText:"",showAddFriend:!1,userInfo:{}}},methods:{handleShowAddFriend(){this.showAddFriend=!0},handleCloseAddFriend(){this.showAddFriend=!1},handleActiveItem(e,t){this.$store.commit("activeFriend",t),this.loadUserInfo(e,t)},handleDelItem(e,t){this.$confirm(`确认要解除与 '${e.nickName}'的好友关系吗?`,"确认解除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$http({url:"/friend/delete/"+e.id,method:"delete"}).then(i=>{this.$message.success("删除好友成功"),this.$store.commit("removeFriend",t),this.$store.commit("removePrivateChat",e.id)})})},handleSendMessage(){let e=this.userInfo,t={type:"PRIVATE",targetId:e.id,showName:e.nickName,headImage:e.headImage};this.$store.commit("openChat",t),this.$store.commit("activeChat",0),this.$router.push("/home/chat")},showFullImage(){this.userInfo.headImage&&this.$store.commit("showFullImageBox",this.userInfo.headImage)},updateFriendInfo(e,t,i){e=JSON.parse(JSON.stringify(e)),e.headImage=t.headImageThumb,e.nickName=t.nickName,this.$http({url:"/friend/update",method:"put",data:e}).then(()=>{this.$store.commit("updateFriend",e),this.$store.commit("updateChatFromFriend",t)})},loadUserInfo(e,t){this.$http({url:"/user/find/"+e.id,method:"get"}).then(e=>{this.userInfo=e})}},computed:{friendStore(){return this.$store.state.friendStore}},mounted(){if(this.friendStore.activeIndex>=0){let e=this.friendStore.friends[this.friendStore.activeIndex];this.loadUserInfo(e,this.friendStore.activeIndex)}}},p=f,v=(i("c67d"),Object(h["a"])(p,s,n,!1,null,"67b158e5",null));t["default"]=v.exports},7875:function(e,t,i){"use strict";i("7b57")},"7b57":function(e,t,i){},c67d:function(e,t,i){"use strict";i("4e44")},ff36:function(e,t,i){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"friend-item",class:e.active?"active":""},[t("div",{staticClass:"avatar"},[t("head-image",{attrs:{url:e.friend.headImage}})],1),t("div",{staticClass:"text"},[t("div",[e._v(e._s(e.friend.nickName))]),t("div",{class:e.online?"online-status  online":"online-status"},[e._v(e._s(e.online?"[在线]":"[离线]"))])]),e.showDelete?t("div",{staticClass:"close",on:{click:function(t){return t.stopPropagation(),e.handleDel()}}},[t("i",{staticClass:"el-icon-close",staticStyle:{border:"none","font-size":"20px",color:"black"},attrs:{title:"添加好友"}})]):e._e(),e._t("default")],2)},n=[],a=i("4036"),r={name:"frinedItem",components:{HeadImage:a["a"]},data(){return{}},methods:{handleDel(){console.log("11111111111111111111"),this.$emit("del",this.friend,this.index)}},props:{friend:{type:Object},active:{type:Boolean},index:{type:Number},showDelete:{type:Boolean,default:!0}},computed:{online(){return this.$store.state.friendStore.friends[this.index].online}}},d=r,o=(i("35fb"),i("2877")),l=Object(o["a"])(d,s,n,!1,null,null,null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-5a71798e.17df0b60.js.map